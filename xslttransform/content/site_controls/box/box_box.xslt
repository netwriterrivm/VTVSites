<xsl:stylesheet version="1.0" exclude-result-prefixes="asp ucidb" xmlns:ucidb="http://www.piet.nl" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:asp="urn:schemas-microsoft-com:datatypes"><xsl:template match="box" mode="box"><xsl:choose><xsl:when test="@IsAdded='True'"><ins><span class="addeditem"><div class="open contrast_lightest"><xsl:attribute name="class"><xsl:text>mod box  </xsl:text><xsl:choose><xsl:when test="@box_fill_mode='open'"> open </xsl:when><xsl:otherwise> closed </xsl:otherwise></xsl:choose><xsl:text></xsl:text><xsl:value-of select="@color"></xsl:value-of><xsl:if test="@foldable='true'"><xsl:text></xsl:text> nw_foldable</xsl:if></xsl:attribute><xsl:choose><xsl:when test="@IsAdded='True'"><ins><span class="addeditem"><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></span></ins></xsl:when><xsl:when test="@IsDeleted='True'"><del><span class="deleteditem"><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></span></del></xsl:when><xsl:otherwise><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></xsl:otherwise></xsl:choose><xsl:apply-templates select="content" mode="content_columncont"></xsl:apply-templates></div></span></ins></xsl:when><xsl:when test="@IsDeleted='True'"><del><span class="deleteditem"><div class="open contrast_lightest"><xsl:attribute name="class"><xsl:text>mod box  </xsl:text><xsl:choose><xsl:when test="@box_fill_mode='open'"> open </xsl:when><xsl:otherwise> closed </xsl:otherwise></xsl:choose><xsl:text></xsl:text><xsl:value-of select="@color"></xsl:value-of><xsl:if test="@foldable='true'"><xsl:text></xsl:text> nw_foldable</xsl:if></xsl:attribute><xsl:choose><xsl:when test="@IsAdded='True'"><ins><span class="addeditem"><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></span></ins></xsl:when><xsl:when test="@IsDeleted='True'"><del><span class="deleteditem"><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></span></del></xsl:when><xsl:otherwise><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></xsl:otherwise></xsl:choose><xsl:apply-templates select="content" mode="content_columncont"></xsl:apply-templates></div></span></del></xsl:when><xsl:otherwise><div class="open contrast_lightest"><xsl:attribute name="class"><xsl:text>mod box  </xsl:text><xsl:choose><xsl:when test="@box_fill_mode='open'"> open </xsl:when><xsl:otherwise> closed </xsl:otherwise></xsl:choose><xsl:text></xsl:text><xsl:value-of select="@color"></xsl:value-of><xsl:if test="@foldable='true'"><xsl:text></xsl:text> nw_foldable</xsl:if></xsl:attribute><xsl:choose><xsl:when test="@IsAdded='True'"><ins><span class="addeditem"><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></span></ins></xsl:when><xsl:when test="@IsDeleted='True'"><del><span class="deleteditem"><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></span></del></xsl:when><xsl:otherwise><xsl:if test="header/@level=''"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='1'"><h2><xsl:attribute name="class"> textHeader1 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='1rs'"><h2><xsl:attribute name="class"> kb_rsheader <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h2></xsl:if><xsl:if test="header/@level='2'"><h3><xsl:attribute name="class"> textHeader2 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h3></xsl:if><xsl:if test="header/@level='3'"><h4><xsl:attribute name="class"> textHeader3 <xsl:if test="@foldable='true'"> nw_foldable_header</xsl:if></xsl:attribute><xsl:apply-templates mode="headercont" select="header"></xsl:apply-templates></h4></xsl:if></xsl:otherwise></xsl:choose><xsl:apply-templates select="content" mode="content_columncont"></xsl:apply-templates></div></xsl:otherwise></xsl:choose></xsl:template>
</xsl:stylesheet>